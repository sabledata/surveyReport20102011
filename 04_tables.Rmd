# Tables

(ref:Table1Caption) Components of the `r yr` and `r yr+1` sablefish research and assessment surveys.
\ \
\ \

```{r Table1, echo=FALSE}

   # --  Create a dataframe for components of the surveys
   Component    <- c(
                     "Stratified", "random ", "sampling (StRS)",    
                     "Traditional"," Offshore","Standardized","(2010 only)","","","","","",
                     "Traditional", "Inlet ","Standardized","",
                     "Exploratory","",""
                     ) 
   Bait         <- c("2 lbs frozen", "squid (bagged),","10 lbs Hake (loose)",
                     "1 lb frozen ", "squid","(bagged)","","","","" ,"","",
                     "2 lbs frozen ", "squid","(bagged)", "",
                     "2 lbs frozen ", "squid (bagged),","10 lbs Hake (loose)") 
   
   Protocol     <- c("1/3 traps discarded,","1/3 traps for tagging,","1/3 traps for biosamples",
                     "50-60 piece LSWMO,","up to 80 piece LSM","","","","","","","",
                     "1/2 traps used for tagging,","1/2 traps used for","biosamples","",
                     "1/3 traps discarded,", "1/3 traps used for tagging,","1/3 traps used for biosamples"
                      )
          
   Locations    <- c("Five spatial strata", "(S1-S5)", "",
                     "Langara Is-North Frederick", 
                     "Hippa Island", "Buck Point",
                     "Gowgaia Bay",  "Cape St.James", 
                     "Triangle Island", "Quatsino Sound", 
                     "Esperenza Inlet", "Barkley Canyon",
                     "Dean/Burke Channel", 
                     "Finlayson Channel", 
                     "Gil Island", 
                     "Portland Inlet",
                     "Koskimo Bay",  "Cliffe Point",   "")
  Completed2010   <-  c("88","","","5","5","5","5","5","5","5","5","5",
                             "5","5","5","5", 
                             "","","")
  Completed2011   <-  c("110","","","","","","","","","","","",
                             "5","5","5","5",
                             "1","1","")

   df           <- data.frame(Component, Bait, Protocol, Locations, Completed2010, Completed2011) 
   df$Locations <- as.character(df$Locations)
   df[2,4]     <- paste("(S","\\textsubscript{1}"," - S","\\textsubscript{5}",")",sep='' )
   colnames(df) <- c("Component", "Bait", "Sample Protocol", "Locations", "2010","2011")

   kableExtra::kable(df, escape = F,  # allows latex for subscript
               booktabs = TRUE, linesep = "",
               format = "latex",  caption = "(ref:Table1Caption)") %>%
               row_spec(0,   bold = T)        %>%
               row_spec(3,   hline_after = T) %>%
               row_spec(12,  hline_after = T) %>%
               row_spec(16,  hline_after = T) %>%
               column_spec(1, width  = "1.8cm") %>%
               column_spec(2, width  = "2.2cm") %>%
               column_spec(3, width  = "3.8cm") %>% 
               column_spec(4, width  = "3.8cm") %>%   
               column_spec(5, width  = "0.6cm") %>%
               column_spec(6, width  = "0.6cm") %>%
     
     
   add_header_above(c(" "= 4, "Sets Completed" = 2), bold=T) %>%  
   kableExtra::kable_styling(font_size = 9, 
                             position = "left",
                             latex_options = "hold_position")

```
\ \
\ \
(ref:Table2Caption) Sets completed for StRS component of the the `r yr` and `r yr+1` (blue) surveys by spatial and depth strata.
\ \
\ \

```{r Table2, echo=FALSE}

       Strata      <- c("S\\textsubscript{1} (South West Coast Vancouver Island or SWCVI)",
                        "S\\textsubscript{2} (North West Coast Vancouver Island or NWCVI)",
                        "S\\textsubscript{3} (Queen Charlotte Sound or QCS)",
                        "S\\textsubscript{4} (South West Coast Haida Gwaii or SWCHG)",
                        "S\\textsubscript{5} (North West Coast Haida Gwaii or NWCHG)")

       act.strata  <- paste("select Year, DEPTH_STRATUM, SPATIAL_STRATUM, COUNT([SET]) AS sets ",
                           "from dbo.GFBIO_RESEARCH_TRIPS ",
                           "group by Year, DEPTH_STRATUM, SPATIAL_STRATUM ",
                           "having Year In( ", yr ,",", yr+1, " ) AND DEPTH_STRATUM IN('RD1','RD2','RD3') ",
                           "order by Year, DEPTH_STRATUM, SPATIAL_STRATUM", sep="")
       # surv.strata <- GetSQLData(act.strata,"Sablefish")
       # write.table(surv.strata, file = paste(path,"Table01.csv",sep=''),row.names=FALSE, na="",col.names=TRUE, sep=",")
       surv.strata  <-  read.csv(paste(path,'Table01.csv',sep=''), header=T)
       surv.strata1 <-  cbind(Strata,
                              surv.strata[surv.strata$Year == yr   & surv.strata$DEPTH_STRATUM=='RD1', ], 
                              surv.strata[surv.strata$Year == yr+1 & surv.strata$DEPTH_STRATUM=='RD1' ,],
                              surv.strata[surv.strata$Year == yr   & surv.strata$DEPTH_STRATUM=='RD2', ], 
                              surv.strata[surv.strata$Year == yr+1 & surv.strata$DEPTH_STRATUM=='RD2' ,],
                              surv.strata[surv.strata$Year == yr   & surv.strata$DEPTH_STRATUM=='RD3', ], 
                              surv.strata[surv.strata$Year == yr+1 & surv.strata$DEPTH_STRATUM=='RD3' ,] )
       
       surv.strata2           <-  surv.strata1[, c(1,5,9,13,17,21,25)]  #reorder table
       surv.strata2$Strata    <-  as.character(surv.strata2$Strata)
       colnames(surv.strata2) <-  c("Spatia Strata","RD1.1","RD1.2","RD2.1", "RD2.2", "RD3.1", "RD3.2")

       
       surv.strata2 <-surv.strata2 %>%
             mutate(TotalStrata1 = select(., RD1.1,RD2.1,RD3.1) %>% rowSums(na.rm = TRUE))  # total year 1
          
       surv.strata2 <-surv.strata2 %>%
             mutate(TotalStrata2 = select(., RD1.2,RD2.2,RD3.2) %>% rowSums(na.rm = TRUE)) # total year 2
       
       surv.strata3 <- rbind(surv.strata2, c("Total",sum(surv.strata2$RD1.1),
                                                     sum(surv.strata2$RD1.2), 
                                                     sum(surv.strata2$RD2.1),
                                                     sum(surv.strata2$RD2.2),
                                                     sum(surv.strata2$RD3.1),
                                                     sum(surv.strata2$RD3.2),
                                                     sum(surv.strata2$TotalStrata1),
                                                     sum(surv.strata2$TotalStrata2) ))
       
       colnames(surv.strata3) <-  c("Spatia Strata", 
                                    paste("RD\\textsubscript{1} ",yr,sep=''), paste("RD\\textsubscript{1} ",yr+1,sep=""),
                                    paste("RD\\textsubscript{2} ",yr,sep=''), paste("RD\\textsubscript{2} ",yr+1,sep=""), 
                                    paste("RD\\textsubscript{3} ",yr,sep=''), paste("RD\\textsubscript{3} ",yr+1,sep=""),
                                    paste("Total ",yr,sep=''),paste("Total ",yr+1,sep='')) 
       
       

      kableExtra::kable(surv.strata3, booktabs = TRUE,linesep = "",
                  format = "latex", escape = F,  # allows latex for subscript
                  caption = "(ref:Table2Caption)") %>%
                  row_spec(0,    bold = T) %>%
                  row_spec(5, hline_after = T) %>%
                  column_spec(2, width  = "0.5cm") %>%
                  column_spec(3, width  = "0.5cm", color="blue" ) %>%
                  column_spec(4, width  = "0.5cm") %>%
                  column_spec(5, width  = "0.5cm", color="blue") %>% 
                  column_spec(6, width  = "0.5cm") %>% 
                  column_spec(7, width  = "0.5cm", color="blue") %>%          
                  column_spec(8, width  = "0.7cm") %>%
                  column_spec(9, width  = "0.5cm", color="blue") %>% 
                  row_spec(0, color="black") %>%
                  row_spec(6, bold=T) %>%
                  add_header_above(c(" "= 1, "Depth Strata" = 6, " " = 2), bold=T) %>%
       kableExtra::kable_styling(font_size = 9, position = "left",latex_options = "hold_position")
 
```
\clearpage
(ref:Table3Caption) Summary of species captured during the `r yr` survey StRS sets conducted by the `r boat1`.
\ \


```{r Table3,  echo=FALSE}

  options(knitr.kable.NA = '')
  data.species   <- paste("exec procRReport_SpeciesSummary ", yr," ,'StRS'",sep="")
  #data.sp.strs  <- GetSQLData(data.species,"Sablefish")
  #write.table(data.sp.strs, file = paste(path,"Table03.csv",sep=''),row.names=FALSE, na="",col.names=TRUE, sep=",")
  data.sp.strs   <-  read.csv(paste(path,'Table03.csv',sep=''), header=T)
     
  data.sp.strs1              <- data.sp.strs[,c(-1,-3,-4,-9)] # remove columns
  data.sp.strs1$Summary_sp   <- cleanf(data.sp.strs1$Summary_sp)  #use the remove duplicates function
  data.sp.strs1$Total_weight <- formatC(data.sp.strs1$Total_weight, format="d", big.mark=",")  # add commas to large numbers
  data.sp.strs1$Total_weight <- gsub("NA", "", data.sp.strs1$Total_weight)
  data.sp.strs1$Common_Name  <- gsub('Rougheye/blackspotted rockfish complex','Rougheye/blackspotted rockfish',data.sp.strs1$Common_Name)
  data.sp.strs1$Scientific_Name  <- gsub("SEBASTES ALEUTIANUS","SEBASTES ALEUTIANUS/MELANOSTICTUS", data.sp.strs1$Scientific_Name)  
  colnames(data.sp.strs1)    <- c( "Category", "Common Name", "Scientific Name" , "Count", "Weight(kg)") # new column names
  
  kableExtra::kable(data.sp.strs1,
                    align = c("l","l","l","c","l"),
                    booktabs = TRUE,   linesep = "",
                    longtable = T,   # can extend to next page
                    format = "latex",  caption = "(ref:Table3Caption)") %>%
                    row_spec(0,    bold = T) %>%
                    row_spec(12,  hline_after = T) %>%
                    row_spec(19,  hline_after = T) %>%
                    row_spec(24,  hline_after = T) %>%
                    column_spec(1, width  = "2.7cm") %>%
                    column_spec(2, width  = "4.0cm") %>%
                    column_spec(3, width  = "4.9cm") %>%
                    column_spec(4, width  = "1.0cm") %>%
                    column_spec(5, width  = "1.3cm") %>%   

  kableExtra::kable_styling(font_size = 8, 
                    position = "left", 
                    latex_options = "repeat_header",
                    repeat_header_text = "continued.", 
                    repeat_header_method = "replace")  
```

\ \
(ref:Table4Caption) Summary of species captured during the `r yr` survey standardized sets at offshore indexing localities.
\ \
\ \

```{r Table4,  echo=FALSE}

  options(knitr.kable.NA = '')
  data.species   <- paste("exec procRReport_SpeciesSummary ", yr," ,'OFFSHORE STANDARDIZED'",sep="")  # procedure from SQL server
  #data.sp.strs  <- GetSQLData(data.species,"Sablefish")
  #write.table(data.sp.strs, file = paste(path,"Table04.csv",sep=''),row.names=FALSE, na="",col.names=TRUE, sep=",")
  data.sp.strs   <-  read.csv(paste(path,'Table04.csv',sep=''), header=T)
     
  data.sp.strs1               <- data.sp.strs[,c(-1,-3,-4,-9)]     # remove columns
  data.sp.strs1$Summary_sp    <- cleanf(data.sp.strs1$Summary_sp)  # use the remove duplicates function
  data.sp.strs1$Total_weight  <- formatC(data.sp.strs1$Total_weight, format="d", big.mark=",")  # add commas to large numbers
  data.sp.strs1$Total_weight  <- gsub("NA", "", data.sp.strs1$Total_weight)
  data.sp.strs1$Common_Name   <- gsub("Rougheye/blackspotted rockfish complex","Rougheye/blackspotted rockfish",data.sp.strs1$Common_Name)
  data.sp.strs1$Scientific_Name  <- gsub("SEBASTES ALEUTIANUS","SEBASTES ALEUTIANUS/MELANOSTICTUS", data.sp.strs1$Scientific_Name)
  colnames(data.sp.strs1)     <- c( "Category", "Common Name", "Scientific Name" , "Count", "Weight(kg)") # new column names
  
  kableExtra::kable(data.sp.strs1,
                    align = c("l","l","l","c","l"),
                    booktabs = TRUE,   linesep = "",
                    longtable = T,
                    format = "latex",  caption = "(ref:Table4Caption)") %>%
                    row_spec(0,   bold = T) %>%
                    row_spec(7,   hline_after = T) %>%
                    row_spec(12,  hline_after = T) %>%
                    row_spec(17,  hline_after = T) %>%
                    column_spec(1, width  = "2.7cm") %>%
                    column_spec(2, width  = "4.0cm") %>%
                    column_spec(3, width  = "4.9cm") %>%
                    column_spec(4, width  = "1.0cm") %>%
                    column_spec(5, width  = "1.3cm") %>%      

    kableExtra::kable_styling( font_size = 8, 
                    position = "left", 
                    latex_options = "repeat_header",
                    repeat_header_text = "continued.", 
                    repeat_header_method = "replace")  
```
\clearpage

(ref:Table5Caption) Summary of species captured during the `r yr` survey standardized sets at mainland inlet localities.
\ \
\ \

```{r Table5, echo=FALSE}

  options(knitr.kable.NA = '')
  data.species    <- paste("exec procRReport_SpeciesSummary ",yr," ,'INLET STANDARDIZED'",sep="")
  #data.sp.inlet  <- GetSQLData(data.species,"Sablefish")
  #write.table(data.sp.inlet, file = paste(path,"Table05.csv",sep=''),row.names=FALSE, na="",col.names=TRUE, sep=",")
  data.sp.inlet   <-  read.csv(paste(path,'Table05.csv',sep=''), header=T)
  
  data.sp.inlet1             <- data.sp.inlet[,c(-1,-3,-4,-9)] # remove columns
  data.sp.inlet1$Summary_sp  <- cleanf(data.sp.inlet1$Summary_sp)  # use the remove duplicates function
  data.sp.inlet1$Total_weight<- formatC(data.sp.inlet1$Total_weight, format="d", big.mark=",") # add commas to large numbers
  data.sp.inlet1$Total_weight<- gsub("NA", "", data.sp.inlet1$Total_weight)
  data.sp.inlet1$Common_Name <- gsub('Rougheye/blackspotted rockfish complex','Rougheye/blackspotted rockfish',data.sp.inlet1$Common_Name)
  data.sp.inlet1$Scientific_Name  <- gsub("SEBASTES ALEUTIANUS","SEBASTES ALEUTIANUS/MELANOSTICTUS", data.sp.inlet1$Scientific_Name)  
  colnames(data.sp.inlet1)   <- c( "Category", "Common Name", "Scientific Name" , "Count", "Weight(kg)") # new column names
  
  kableExtra::kable(data.sp.inlet1,
                    align = c("l","l","l","c","l"),
                    booktabs = TRUE,linesep = "",
                    format = "latex",  caption = "(ref:Table5Caption)") %>%
                    row_spec(0,    bold = T) %>%
                    row_spec(4,    hline_after = T) %>%
                    row_spec(8,    hline_after = T) %>%
                    row_spec(10,   hline_after = T) %>%
                    column_spec(1, width  = "2.7cm") %>%
                    column_spec(2, width  = "4.0cm") %>%
                    column_spec(3, width  = "4.9cm") %>%
                    column_spec(4, width  = "1.0cm") %>%
                    column_spec(5, width  = "1.3cm") %>% 
    
  kableExtra::kable_styling(font_size = 8, 
                    position = "left",
                    latex_options = "hold_position")  

```
\ \
\ \
(ref:Table6Caption) Summary of species captured during the `r yr+1` survey StRS sets conducted by the `r boat2`.
\ \
\ \

```{r Table6,  echo=FALSE}

  options(knitr.kable.NA = '')
  data.species   <- paste("exec procRReport_SpeciesSummary ", yr+1," ,'StRS'",sep="")
  #data.sp.strs   <- GetSQLData(data.species,"Sablefish")
  #write.table(data.sp.strs, file = paste(path,"Table06.csv",sep=''),row.names=FALSE, na="",col.names=TRUE, sep=",")
  data.sp.strs   <-  read.csv(paste(path,'Table06.csv',sep=''), header=T)
  
  data.sp.strs2 <- data.sp.strs[,c(-1,-3,-4,-9)] # remove columns
  data.sp.strs2$Summary_sp    <- cleanf(data.sp.strs2$Summary_sp)  # use the remove duplicates function
  data.sp.strs2$Total_weight  <- formatC(data.sp.strs2$Total_weight, format="d", big.mark=",") # add commas to large numbers
  data.sp.strs2$Total_weight  <- gsub("NA", "", data.sp.strs2$Total_weight)
  data.sp.strs2$Common_Name <- gsub('Rougheye/blackspotted rockfish complex','Rougheye/blackspotted rockfish', data.sp.strs2$Common_Name) 
  data.sp.strs2$Scientific_Name  <- gsub("SEBASTES ALEUTIANUS","SEBASTES ALEUTIANUS/MELANOSTICTUS", data.sp.strs2$Scientific_Name)   
  colnames(data.sp.strs2)  <- c( "Category", "Common Name", "Scientific Name" , "Count", "Weight(kg)") # new column names

  kableExtra::kable(data.sp.strs2,
                    align = c("l","l","l","c","l"),
                    booktabs = TRUE, 
                    linesep = "",
                    longtable = T,
                    format = "latex",  caption = "(ref:Table6Caption)") %>%
                    row_spec(0,    bold = T) %>%
                    row_spec(18,  hline_after = T) %>%
                    row_spec(33,  hline_after = T) %>%
                    row_spec(37,  hline_after = T) %>%
                    column_spec(1, width  = "2.7cm") %>%
                    column_spec(2, width  = "4.0cm") %>%
                    column_spec(3, width  = "4.9cm") %>%
                    column_spec(4, width  = "1.0cm") %>%
                    column_spec(5, width  = "1.3cm") %>%  
    
    kableExtra::kable_styling(font_size = 8, 
                     position = "left", 
                     latex_options = "repeat_header",
                     repeat_header_text = "continued.", 
                     repeat_header_method = "replace")  
```
\clearpage

(ref:Table7Caption) Summary of species captured during the `r yr + 1`  survey standardized sets at mainland inlet localities.
\ \
\ \

```{r Table7, echo=FALSE}

  options(knitr6.kable.NA = '')
  dtSP          <- paste("exec procRReport_SpeciesSummary ",yr+1," ,'INLET STANDARDIZED'",sep="")
  #datSP        <- GetSQLData(dtSP,"Sablefish")
  #write.table(datSP, file = paste(path,"Table07.csv",sep=''),row.names=FALSE, na="",col.names=TRUE, sep=",")
  data.sp.inlet <-  read.csv(paste(path,'Table07.csv',sep=''), header=T)
  
  data.sp.inlet2             <- data.sp.inlet[,c(-1,-3,-4,-9)]   # remove columns
  data.sp.inlet2$Summary_sp  <- cleanf(data.sp.inlet$Summary_sp)  # use the remove duplicates function
  data.sp.inlet2$Total_weight<- formatC(data.sp.inlet2$Total_weight, format="d", big.mark=",")  # add commas to large numbers
  data.sp.inlet2$Total_weight<- gsub("NA", "", data.sp.inlet2$Total_weight)
  data.sp.inlet2$Common_Name <- gsub('Rougheye/blackspotted rockfish complex','Rougheye/blackspotted rockfish', data.sp.inlet2$Common_Name)
  data.sp.inlet2$Scientific_Name  <- gsub("SEBASTES ALEUTIANUS","SEBASTES ALEUTIANUS/MELANOSTICTUS", data.sp.inlet2$Scientific_Name)  
  colnames(data.sp.inlet2)   <- c( "Category", "Common Name", "Scientific Name" , "Count", "Weight(kg)") # new column names

  kableExtra::kable(data.sp.inlet2,
                    align = c("l","l","l","c","l"),
                    booktabs = TRUE,linesep = "",
                    format = "latex",  caption = "(ref:Table7Caption)") %>%
                    row_spec(0,  bold = T) %>%
                    row_spec(4,  hline_after = T) %>%
                    row_spec(5,  hline_after = T) %>%
                    row_spec(7,  hline_after = T) %>%
                    column_spec(1, width  = "2.7cm") %>%
                    column_spec(2, width  = "4.0cm") %>%
                    column_spec(3, width  = "4.9cm") %>%
                    column_spec(4, width  = "1.0cm") %>%
                    column_spec(5, width  = "1.3cm") %>%  
    
  kableExtra::kable_styling(font_size = 8, 
                    position = "left",
                    latex_options = "hold_position") 

```
\ \
\ \
(ref:Table8Caption) Summary of species captured during the `r yr + 1` survey exploratory sets near Cliffe Point and Koskimo Bay on Vancouver Island. 
\ \
\ \

```{r Table8, echo=FALSE}

  options(knitr.kable.NA = '')
  dtSP            <- paste("exec procRReport_SpeciesSummary ",yr+1," ,'NO SET TYPE'",sep="")
  #datSP          <- GetSQLData(dtSP,"Sablefish")
  #write.table(datSP, file = paste(path,"Table08.csv",sep=''),row.names=FALSE, na="",col.names=TRUE, sep=",")
  data.sp.explore <-  read.csv(paste(path,'Table08.csv',sep=''), header=T)
  
  data.sp.explore2              <- data.sp.explore[,c(-1,-3,-4,-9)] # remove columns
  data.sp.explore2$Summary_sp   <- cleanf(data.sp.explore$Summary_sp)  #use the remove duplicates function
  data.sp.explore2$Total_weight <- formatC(data.sp.explore2$Total_weight, format="d", big.mark=",")  # add commas to large numbers
  data.sp.explore2$Total_weight <- gsub("NA", "", data.sp.explore2$Total_weight)
  data.sp.explore2$Common_Name  <- gsub('Rougheye/blackspotted rockfish complex','Rougheye/blackspotted rockfish', data.sp.explore2$Common_Name) 
  data.sp.explore2$Scientific_Name  <- gsub("SEBASTES ALEUTIANUS","SEBASTES ALEUTIANUS/MELANOSTICTUS", data.sp.explore2$Scientific_Name)   
  colnames(data.sp.explore2)    <- c( "Category", "Common Name", "Scientific Name" , "Count", "Weight(kg)") # new column names

  kableExtra::kable(data.sp.explore2,
                    align = c("l","l","l","c","l"),
                    booktabs = TRUE,
                    linesep = "",
                    format = "latex",  caption = "(ref:Table8Caption)") %>%
                    row_spec(0,  bold = T) %>%
                    row_spec(6,  hline_after = T) %>%
                    row_spec(10,  hline_after = T) %>%
                    row_spec(13,  hline_after = T) %>%
                    column_spec(1, width  = "2.7cm") %>%
                    column_spec(2, width  = "4.0cm") %>%
                    column_spec(3, width  = "4.9cm") %>%
                    column_spec(4, width  = "1.0cm") %>%
                    column_spec(5, width  = "1.3cm") %>%  
    
  kableExtra::kable_styling(font_size = 8, 
                    position = "left",
                    latex_options = "hold_position") 

```
\clearpage
(ref:table9Caption) Summary of sablefish biological data collected at the `r yr` stratified random survey (StRS) sites.
\ \
\ \

```{r Table9, echo=FALSE}

    newdata$Depth  <- as.character(newdata$Depth)
    newdata$Spatial<-as.character(newdata$Spatial)
    newdata[4,2]   <- "Mean"
    newdata[8,2]   <- "Mean"
    newdata[12,2]  <- "Mean"
    newdata[16,2]  <- "Mean"
    newdata[20,2]  <- "Mean"
    newdata[1,1]   <- "S\\textsubscript{1}"
    newdata[5,1]   <- "S\\textsubscript{2}"
    newdata[9,1]   <- "S\\textsubscript{3}"
    newdata[13,1]  <- "S\\textsubscript{4}"
    newdata[17,1]  <- "S\\textsubscript{5}"
    newdata[1,2]   <- "RD\\textsubscript{1}"
    newdata[2,2]   <- "RD\\textsubscript{2}"
    newdata[3,2]   <- "RD\\textsubscript{3}"  
    newdata[5,2]   <- "RD\\textsubscript{1}"
    newdata[6,2]   <- "RD\\textsubscript{2}"
    newdata[7,2]   <- "RD\\textsubscript{3}"
    newdata[9,2]   <- "RD\\textsubscript{1}"
    newdata[10,2]   <- "RD\\textsubscript{2}"
    newdata[11,2]   <- "RD\\textsubscript{3}"
    newdata[13,2]   <- "RD\\textsubscript{1}"
    newdata[14,2]   <- "RD\\textsubscript{2}"
    newdata[15,2]   <- "RD\\textsubscript{3}"
    newdata[17,2]   <- "RD\\textsubscript{1}"
    newdata[18,2]   <- "RD\\textsubscript{2}"
    newdata[19,2]   <- "RD\\textsubscript{3}"    
    
    kableExtra::kable(newdata, 
                      row.names = FALSE,
                      escape = F,  # allows latex for subscript
                      booktabs = TRUE,   linesep = "",
                      format = "latex",  caption = "(ref:table9Caption)") %>% 

    add_header_above(c( "Strata"= 2,
                        "Proportion" = 2, 
                        "Mean Fork Length (mm)" = 3),bold = T) %>%
      
    kableExtra::kable_styling(font_size = 9, position = "left",latex_options = "hold_position") %>%
                      row_spec(0,    bold = T) %>%
                      row_spec(3,    hline_after = T) %>%
                      row_spec(4,    bold = T, hline_after = T) %>%
                      row_spec(7,    hline_after = T) %>% 
                      row_spec(8,    bold = T, hline_after = T) %>%      
                      row_spec(11,   hline_after = T) %>%
                      row_spec(12,   bold = T, hline_after = T) %>%      
                      row_spec(15,   hline_after = T)   %>% 
                      row_spec(16,   bold = T, hline_after = T) %>%   
                      row_spec(19,   hline_after = T)   %>% 
                      row_spec(20,   bold = T)  %>%
                      column_spec(1, width  = "2.0cm") %>%
                      column_spec(2, width  = "2.0cm") %>%
                      column_spec(3, width  = "1.2cm") %>%
                      column_spec(4, width  = "1.2cm") %>%
                      column_spec(5, width  = "1.2cm") %>%
                      column_spec(6, width  = "1.2cm") %>%                  
                      column_spec(7, width  = "1.2cm")
      
```
\ \
\ \
(ref:Table10Caption) Summary of sablefish biological data collected at the `r yr` offshore localities.
\ \
\ \
```{r Table10, echo=FALSE}

  options(knitr.kable.NA = '')
  bio.summary       <- paste(" select Year, Locality, TRADITIONAL_OFFSHORE_INDEXING, Depth, PropMales, PropFemales, ",
                             " MalesMnFkLen, FemalesMnFkLen from  dbo.GFBIO_SABLE_BIO_SUMMARY ",
                             " where (Year = ", yr, ") AND (TRADITIONAL_OFFSHORE_INDEXING = 1) ",
                             " order by Locality, Depth", sep="")
  #bio.summary.trad  <- GetSQLData(bio.summary, "Sablefish")
  #write.table(bio.summary.trad, file = paste(path,"Table10.csv",sep=''),row.names=FALSE, na="",col.names=TRUE, sep=",")
  bio.summary.trad  <-  read.csv(paste(path,'Table10.csv',sep=''), header=T)
  
  bio.summary.trad          <-  bio.summary.trad[,c(-1,-3,-4)]  # remove some columns
  bio.summary.trad$Locality <-  as.character(bio.summary.trad$Locality)   # convert to charaacter value
  bio.summary.trad$order    <-  c(9,3,5,8,4,2,1,7,6)  # reorder table
  bio.summary.trad          <-  bio.summary.trad[order(bio.summary.trad$order),]  # reorder based on North to South localities
  bio.means                 <-  c('Mean', 
                                   round(mean(bio.summary.trad$PropMales),2),  
                                   round(mean(bio.summary.trad$PropFemales),2),
                                   round(mean(bio.summary.trad$MalesMnFkLen),0),  
                                   round(mean(bio.summary.trad$FemalesMnFkLen),0),10)
  bio.trad.summary          <-  rbind(bio.summary.trad, bio.means)  # add mean calculations
  bio.trad.summary          <-  bio.trad.summary[,c(-6)]
  colnames(bio.trad.summary)<- c( "Offshore Indexing", "Males", "Females" , "Males", "Females") # new column names
  
  kableExtra::kable(bio.trad.summary, row.names = FALSE,
                    booktabs = TRUE,   linesep = "",
                    format = "latex",  
                    caption = "(ref:Table10Caption)") %>%
    
  add_header_above( c("Locality"= 1,
                      "Proportion" = 2, 
                      "Mean Fork Length (mm)" = 2),bold = T) %>%
      
  kableExtra::kable_styling(font_size = 9, position = "left",latex_options = "hold_position") %>%
                    row_spec(0,    bold = T) %>%
                    row_spec(9,    hline_after = T)   %>%  # line after the 9 localities
                    row_spec(10,   bold = T) %>%
                    column_spec(1, width  = "4.8cm") %>%
                    column_spec(2, width  = "1.2cm") %>%
                    column_spec(3, width  = "1.2cm") %>%
                    column_spec(4, width  = "1.2cm") %>%
                    column_spec(5, width  = "1.2cm") 
  
```
\clearpage

(ref:table11Caption) Summary of sablefish biological data collected at the  `r yr` mainland inlet sites.
\ \
\ \
```{r Table11, echo=FALSE}

    bio.summaryI        <- paste(" select Locality, PropMales, PropFemales, ",
                                 " MalesMnFkLen, FemalesMnFkLen, TaggedMnFkLen from  dbo.GFBIO_SABLE_BIO_SUMMARY ",
                                 " where (Year = ", yr, ") AND (TRADITIONAL_INLET_LOCALITY = 1) ", 
                                 " ORDER BY Locality DESC", sep="")
    #bio.summary.inlet  <- GetSQLData(bio.summaryI, "Sablefish")
    #write.table(bio.summary.inlet, file = paste(path,"Table11.csv",sep=''),row.names=FALSE, na="",col.names=TRUE, sep=",")
    bio.summary.inlet   <-  read.csv(paste(path,'Table11.csv',sep=''), header=T)
    
    bio.summary.inlet$Locality  <-  as.character(bio.summary.inlet$Locality)
    bio.means.line              <-  c('Mean', round(mean(bio.summary.inlet$PropMales),2),    
                                       round(mean(bio.summary.inlet$PropFemales),2),
                                       round(mean(bio.summary.inlet$MalesMnFkLen),0), 
                                       round(mean(bio.summary.inlet$FemalesMnFkLen),0),
                                       round(mean(bio.summary.inlet$TaggedMnFkLen),0) )
    bio.summary.inlet           <-  rbind(bio.summary.inlet, bio.means.line)
    colnames(bio.summary.inlet) <-  c( "Mainland Inlet", "Males", "Females" , "Males", "Females", "Tagged")# new column names
                             
    kableExtra::kable(bio.summary.inlet, row.names = FALSE,
                      booktabs = TRUE,   linesep = "",
                      format = "latex",  caption = "(ref:table11Caption)") %>%
      
    add_header_above(c("Locality"= 1,
                       "Proportion" = 2, 
                       "Mean Fork Length (mm)" = 3), bold = T) %>%
      
    kableExtra::kable_styling(font_size = 9, position = "left",latex_options = "hold_position") %>%
                      row_spec(0,    bold = T) %>%
                      row_spec(4,    hline_after = T) %>%
                      row_spec(5,    bold = T) %>%
                      column_spec(1, width  = "4.8cm") %>%
                      column_spec(2, width  = "1.2cm") %>%
                      column_spec(3, width  = "1.2cm") %>%
                      column_spec(4, width  = "1.2cm") %>%
                      column_spec(5, width  = "1.2cm") %>%
                      column_spec(6, width  = "1.2cm") 
      
```
\ \
\ \
(ref:table12Caption)  Summary of sablefish biological data collected at the `r yr+1` stratified random survey (StRS) sites.
\ \
\ \

```{r Table12, echo=FALSE}

    newdata.2$Depth  <- as.character(newdata.2$Depth)
    newdata.2$Spatial<- as.character(newdata.2$Spatial)
    newdata.2[4,2]   <- "Mean"
    newdata.2[8,2]   <- "Mean"
    newdata.2[12,2]  <- "Mean"
    newdata.2[16,2]  <- "Mean"
    newdata.2[20,2]  <- "Mean"
    newdata.2[1,1]   <- "S\\textsubscript{1}"
    newdata.2[5,1]   <- "S\\textsubscript{2}"
    newdata.2[9,1]   <- "S\\textsubscript{3}"
    newdata.2[13,1]  <- "S\\textsubscript{4}"
    newdata.2[17,1]  <- "S\\textsubscript{5}"
    newdata.2[1,2]   <- "RD\\textsubscript{1}"
    newdata.2[2,2]   <- "RD\\textsubscript{2}"
    newdata.2[3,2]   <- "RD\\textsubscript{3}"  
    newdata.2[5,2]   <- "RD\\textsubscript{1}"
    newdata.2[6,2]   <- "RD\\textsubscript{2}"
    newdata.2[7,2]   <- "RD\\textsubscript{3}"
    newdata.2[9,2]   <- "RD\\textsubscript{1}"
    newdata.2[10,2]  <- "RD\\textsubscript{2}"
    newdata.2[11,2]  <- "RD\\textsubscript{3}"
    newdata.2[13,2]  <- "RD\\textsubscript{1}"
    newdata.2[14,2]  <- "RD\\textsubscript{2}"
    newdata.2[15,2]  <- "RD\\textsubscript{3}"
    newdata.2[17,2]  <- "RD\\textsubscript{1}"
    newdata.2[18,2]  <- "RD\\textsubscript{2}"
    newdata.2[19,2]  <- "RD\\textsubscript{3}"    
    
    
    kableExtra::kable(newdata.2,row.names = FALSE,
                      booktabs = TRUE,linesep = "",
                      escape = F,  # allows latex for subscript
                      format = "latex",  caption = "(ref:table12Caption)") %>% 
    add_header_above(c( "Strata"= 2,
                        "Proportion" = 2, 
                        "Mean Fork Length (mm)" = 3),bold = T) %>%
      
    kableExtra::kable_styling(font_size = 9, position = "left",latex_options = "hold_position") %>%
                      row_spec(0,    bold = T) %>%
                      row_spec(3,    hline_after = T) %>%
                      row_spec(4,    bold = T, hline_after = T) %>%
                      row_spec(7,    hline_after = T) %>% 
                      row_spec(8,    bold = T, hline_after = T) %>%      
                      row_spec(11,   hline_after = T) %>%
                      row_spec(12,   bold = T, hline_after = T) %>%      
                      row_spec(15,   hline_after = T)   %>% 
                      row_spec(16,   bold = T, hline_after = T) %>%   
                      row_spec(19,   hline_after = T)   %>% 
                      row_spec(20,   bold = T)  %>%
                      column_spec(1, width  = "2.0cm") %>%
                      column_spec(2, width  = "2.0cm") %>%
                      column_spec(3, width  = "1.2cm") %>%
                      column_spec(4, width  = "1.2cm") %>%
                      column_spec(5, width  = "1.2cm") %>%
                      column_spec(6, width  = "1.2cm") %>%                  
                      column_spec(7, width  = "1.2cm")
    
```
\clearpage
(ref:table13Caption) Summary of sablefish biological data collected at the  `r yr+1` mainland inlet sites.
\ \
\ \

```{r Table13, echo=FALSE}

    bio.summaryI2        <-  paste(" select Locality, PropMales, PropFemales, ",
                                   " MalesMnFkLen, FemalesMnFkLen, TaggedMnFkLen from  dbo.GFBIO_SABLE_BIO_SUMMARY ",
                                   " where (Year = ", yr + 1, ") AND (TRADITIONAL_INLET_LOCALITY = 1)  ",
                                   " ORDER BY Locality DESC", sep="")
    bio.summary.inlet2   <-  GetSQLData(bio.summaryI2, "Sablefish")
    write.table(bio.summary.inlet2, file = paste(path,"Table13.csv",sep=''),row.names=FALSE, na="",col.names=TRUE, sep=",")
    bio.summary.inlet2   <-  read.csv(paste(path,'Table13.csv',sep=''), header=T)
    
    bio.summary.inlet2$Locality <-  as.character(bio.summary.inlet2$Locality) # change to character column
    bio.means.line2             <-  c('Mean', 
                                       round(mean(bio.summary.inlet2$PropMales),2),    
                                       round(mean(bio.summary.inlet2$PropFemales),2),
                                       round(mean(bio.summary.inlet2$MalesMnFkLen),0), 
                                       round(mean(bio.summary.inlet2$FemalesMnFkLen),0),
                                       round(mean(bio.summary.inlet2$TaggedMnFkLen),0) )
    bio.summary.inlet2          <-  rbind(bio.summary.inlet2, bio.means.line2)
    colnames(bio.summary.inlet2)<-  c( "Mainland Inlet", "Males", "Females" , "Males", "Females", "Tagged")# new column names
                             
    kableExtra::kable(bio.summary.inlet2, row.names = FALSE,
                      booktabs = TRUE,   linesep = "",
                      format = "latex",  caption = "(ref:table13Caption)") %>% 
      
    add_header_above(c("Locality"= 1,
                       "Proportion" = 2, 
                       "Mean Fork Length (mm)" = 3),bold = T) %>%
      
    kableExtra::kable_styling(font_size = 9, position = "left",latex_options = "hold_position") %>%
                      row_spec(0,    bold = T) %>%
                      row_spec(4,    hline_after = T) %>%
                      row_spec(5,    bold = T) %>%
                      column_spec(1, width  = "4.8cm") %>%
                      column_spec(2, width  = "1.2cm") %>%
                      column_spec(3, width  = "1.2cm") %>%
                      column_spec(4, width  = "1.2cm") %>%
                      column_spec(5, width  = "1.2cm") %>%
                      column_spec(6, width  = "1.2cm") 
      
```

\clearpage

(ref:table14Caption) Count of tagged fish released since 1991 (including re-released fish) and counts of verified tag recoveries by year including any recoveries that had no reported year. The total count of tag recoveries represent the sum of all verified recoveries.
\ \
\ \
\ \

```{r Table14,  echo=FALSE}

  # table FishTag.dbo.WEB_TAG_REVIEW is created in procedure FishTag.dbo.Procedure5_Build_WebData
  # each year must be added
  tag.release  <- paste("select [Release year] as [Year], Total_released as [Released], ",
                        "Rec_1991 as [91], Rec_1992 as [92], Rec_1993 as [93], ",
                        "Rec_1994 as [94], Rec_1995 as [95], Rec_1996 as [96], ",
                        "Rec_1997 as [97], Rec_1998 as [98], Rec_1999 as [99], ",
                        "Rec_2000 as [00], Rec_2001 as [01], Rec_2002 as [02], ",
                        "Rec_2003 as [03], Rec_2004 as [04], Rec_2005 as [05], ",
                        "Rec_2006 as [06], Rec_2007 as [07], Rec_2008 as [08], ",
                        "Rec_2009 as [09], Rec_2010 as [10], Rec_2011 as [11], ", 
                        "Total_recovered as [Total], No_recovery_year as [No Year] ",
                        "from dbo.WEB_TAG_REVIEW where [Release year] <= ", yr+1, "order by [Release year]",sep="")
   #data.tag.rel <- GetSQLData(tag.release,"FishTag")
   #write.table(data.tag.rel, file = paste(path,"table14.csv",sep=''),row.names=FALSE, na="",col.names=TRUE, sep=",")
   data.tag.rel  <- read.csv(paste(path,'table14.csv',sep=''), header=T)

   data.tag.rel$Release  <- formatC(data.tag.rel$Release, format="d", big.mark=",") # separate numbers with commas
   data.tag.rel$X96      <- formatC(data.tag.rel$X96, format="d", big.mark=",")
   data.tag.rel$X97      <- formatC(data.tag.rel$X97, format="d", big.mark=",")
   data.tag.rel$X98      <- formatC(data.tag.rel$X98, format="d", big.mark=",")   
   data.tag.rel$X99      <- formatC(data.tag.rel$X99, format="d", big.mark=",")
   data.tag.rel$X00      <- formatC(data.tag.rel$X00, format="d", big.mark=",")
   data.tag.rel$X01      <- formatC(data.tag.rel$X01, format="d", big.mark=",")
   data.tag.rel$X02      <- formatC(data.tag.rel$X02, format="d", big.mark=",")
   data.tag.rel$X03      <- formatC(data.tag.rel$X03, format="d", big.mark=",")
   data.tag.rel$X04      <- formatC(data.tag.rel$X04, format="d", big.mark=",")
   data.tag.rel$X05      <- formatC(data.tag.rel$X05, format="d", big.mark=",")
   data.tag.rel$X06      <- formatC(data.tag.rel$X06, format="d", big.mark=",")
   data.tag.rel$X07      <- formatC(data.tag.rel$X07, format="d", big.mark=",") 
   data.tag.rel$X08      <- formatC(data.tag.rel$X08, format="d", big.mark=",")
   data.tag.rel$X09      <- formatC(data.tag.rel$X09, format="d", big.mark=",") 
   data.tag.rel$X10      <- formatC(data.tag.rel$X10, format="d", big.mark=",")
   data.tag.rel$X11      <- formatC(data.tag.rel$X11, format="d", big.mark=",") 
   data.tag.rel$Total    <- formatC(data.tag.rel$Total, format="d", big.mark=",")   
   data.tag.rel$Release  <- gsub("NA", "",  data.tag.rel$Release)
   
   names(data.tag.rel)[3]     <-  "91"
   names(data.tag.rel)[4]     <-  "92"
   names(data.tag.rel)[5]     <-  "93"
   names(data.tag.rel)[6]     <-  "94"
   names(data.tag.rel)[7]     <-  "95"
   names(data.tag.rel)[8]     <-  "96"
   names(data.tag.rel)[9]     <-  "97"
   names(data.tag.rel)[10]    <-  "98"
   names(data.tag.rel)[11]    <-  "99"
   names(data.tag.rel)[12]    <-  "00" 
   names(data.tag.rel)[13]    <-  "01"
   names(data.tag.rel)[14]    <-  "02" 
   names(data.tag.rel)[15]    <-  "03"
   names(data.tag.rel)[16]    <-  "04" 
   names(data.tag.rel)[17]    <-  "05"
   names(data.tag.rel)[18]    <-  "06" 
   names(data.tag.rel)[19]    <-  "07"
   names(data.tag.rel)[20]    <-  "08" 
   names(data.tag.rel)[21]    <-  "09"
   names(data.tag.rel)[22]    <-  "10"  
   names(data.tag.rel)[23]    <-  "11" 
   names(data.tag.rel)[25]    <-  "No Year" 
   
   csasdown::csas_table(data.tag.rel, longtable = T,
                        format = "latex",  
                        landscape= TRUE,
                        repeat_header_text = "Continued...", 
                        caption = "(ref:table14Caption)") %>%
    
   kableExtra::kable_styling(font_size = 8.5, position = "left",latex_options = "hold_position") %>%
                     column_spec(0,bold=T) %>%
                     column_spec(1,width  = "0.4cm") %>%
                     column_spec(2,width  = "1.1cm") %>%
                     column_spec(3,width  = "0.3cm") %>%  # 91
                     column_spec(4,width  = "0.3cm") %>%
                     column_spec(5,width  = "0.3cm") %>%  # 93 
                     column_spec(6,width  = "0.3cm") %>% 
                     column_spec(7,width  = "0.3cm") %>%  # 95
                     column_spec(8,width  = "0.5cm") %>% 
                     column_spec(9,width  = "0.5cm") %>%  # 97
                     column_spec(10,width = "0.5cm") %>% 
                     column_spec(11,width = "0.5cm") %>% 
                     column_spec(12,width = "0.5cm") %>%  # 00
                     column_spec(13,width = "0.5cm") %>%
                     column_spec(14,width = "0.5cm") %>%
                     column_spec(15,width = "0.5cm") %>%  # 03
                     column_spec(16,width = "0.5cm") %>%
                     column_spec(17,width = "0.5cm") %>%  # 05
                     column_spec(18,width = "0.5cm") %>%
                     column_spec(19,width = "0.5cm") %>%  # 07
                     column_spec(20,width = "0.3cm") %>%     
                     column_spec(21,width = "0.3cm") %>%  # 09    
                     column_spec(22,width = "0.3cm") %>%     
                     column_spec(23,width = "0.3cm") %>%  # 11   
                     column_spec(24,width = "0.5cm") %>%  # total   
                     column_spec(25,width = "0.5cm") 
``` 

